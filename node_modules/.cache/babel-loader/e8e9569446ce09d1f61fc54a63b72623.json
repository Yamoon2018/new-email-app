{"ast":null,"code":"//var nodemail = require('nodemailer');\nvar mailgun=require(\"mailgun-js\");var DOMAIN='https://new-email-app.herokuapp.com/';var api_key='6e3b8f6090c00c22a964a71df0571b60-2af183ba-540063c1';var mg=mailgun({apiKey:api_key,domain:DOMAIN});module.exports=function send_email_db(req){console.log(\"req==\"+req);//break;\nvar receiver_emails='';var sender_email='';var date=new Date();if(req){sender_email=req.sender_email;receiver_emails=req.receiver_email.split(',');var email_status=req.email_status;var email_subject=req.email_subject;var email_body=req.email_body;console.log(\"convert==\"+receiver_emails.length);}var email_output=\"\\n        \\n        <h3>Your emails sent \".concat(email_subject,\"</h3>\\n        <ul>\\n            <li> Email \").concat(email_body,\"</li>\\n        </ul>\\n    \");// let tranport_email = nodemail.createTransport({\n//   port: 587,\n//   address: 'smtp.mailgun.org',    \n//   host: 'https://new-email-app.herokuapp.com/',\n//     auth: {\n//         user: 'postmaster@sandbox9ec8e5daaec146fca37a45479baea5f2.mailgun.org' ,\n//         pass: '98e50b79f92e630a413bc3d8a7716c02-2af183ba-fa201257',\n//     }\n// });\nvar email_counter_start=0;var receiver_email_list=0;email_status===\"all\"?receiver_email_list=[receiver_emails]:receiver_email_list=receiver_emails;while(email_counter_start<receiver_email_list.length){console.log(\"email options==\"+receiver_email_list[email_counter_start]);var mailoptions={from:sender_email,//\"yamin.barakat@gmail.com\",\nto:receiver_email_list[email_counter_start],subject:email_subject+'  '+date,text:email_body,html:email_output};mg.messages().send(mailoptions,function(error,body){console.log(body);});// tranport_email.sendMail(mailoptions, (err, info)=>{\n//     if(err) {\n//         return console.log(err);\n//     }\n//     console.log('email sent %s', info.messageId );\n// });\nemail_counter_start+=1;}//send_DB(req, res);\n};","map":{"version":3,"sources":["/home/yamin/My_repos/new-email-app/new-email-app/src/send_email_smtp.js"],"names":["mailgun","require","DOMAIN","api_key","mg","apiKey","domain","module","exports","send_email_db","req","console","log","receiver_emails","sender_email","date","Date","receiver_email","split","email_status","email_subject","email_body","length","email_output","email_counter_start","receiver_email_list","mailoptions","from","to","subject","text","html","messages","send","error","body"],"mappings":"AAAA;AACA,GAAMA,CAAAA,OAAO,CAAGC,OAAO,CAAC,YAAD,CAAvB,CACA,GAAMC,CAAAA,MAAM,CAAG,sCAAf,CACA,GAAMC,CAAAA,OAAO,CAAG,oDAAhB,CACA,GAAMC,CAAAA,EAAE,CAAGJ,OAAO,CAAC,CAACK,MAAM,CAAEF,OAAT,CAAkBG,MAAM,CAAEJ,MAA1B,CAAD,CAAlB,CAEAK,MAAM,CAACC,OAAP,CAAgB,QAASC,CAAAA,aAAT,CAAuBC,GAAvB,CAA2B,CACvCC,OAAO,CAACC,GAAR,CAAY,QAASF,GAArB,EACA;AACA,GAAIG,CAAAA,eAAe,CAAC,EAApB,CACA,GAAIC,CAAAA,YAAY,CAAC,EAAjB,CACA,GAAIC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,EAAX,CACA,GAAGN,GAAH,CAAO,CACDI,YAAY,CAAGJ,GAAG,CAACI,YAAnB,CACFD,eAAe,CAAGH,GAAG,CAACO,cAAJ,CAAmBC,KAAnB,CAAyB,GAAzB,CAAlB,CAEA,GAAIC,CAAAA,YAAY,CAAMT,GAAG,CAACS,YAA1B,CACA,GAAIC,CAAAA,aAAa,CAAGV,GAAG,CAACU,aAAxB,CACA,GAAIC,CAAAA,UAAU,CAAGX,GAAG,CAACW,UAArB,CACAV,OAAO,CAACC,GAAR,CAAY,YAAYC,eAAe,CAACS,MAAxC,EACH,CAGD,GAAMC,CAAAA,YAAY,oDAESH,aAFT,wDAIGC,UAJH,8BAAlB,CAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAIG,CAAAA,mBAAmB,CAAE,CAAzB,CACA,GAAIC,CAAAA,mBAAmB,CAAE,CAAzB,CAEAN,YAAY,GAAK,KAAjB,CAAyBM,mBAAmB,CAAC,CAACZ,eAAD,CAA7C,CAAiEY,mBAAmB,CAAGZ,eAAvF,CAEA,MAAQW,mBAAmB,CAAGC,mBAAmB,CAACH,MAAlD,CAA0D,CAExDX,OAAO,CAACC,GAAR,CAAY,kBAAkBa,mBAAmB,CAACD,mBAAD,CAAjD,EACE,GAAIE,CAAAA,WAAW,CAAG,CACdC,IAAI,CAAEb,YADQ,CACM;AACpBc,EAAE,CAAEH,mBAAmB,CAACD,mBAAD,CAFT,CAGdK,OAAO,CAAET,aAAa,CAAC,IAAd,CAAmBL,IAHd,CAIde,IAAI,CAAET,UAJQ,CAKdU,IAAI,CAAER,YALQ,CAAlB,CAQAnB,EAAE,CAAC4B,QAAH,GAAcC,IAAd,CAAmBP,WAAnB,CAAgC,SAAUQ,KAAV,CAAiBC,IAAjB,CAAuB,CACnDxB,OAAO,CAACC,GAAR,CAAYuB,IAAZ,EACH,CAFD,EAIA;AACA;AACA;AACA;AACA;AACA;AAEFX,mBAAmB,EAAG,CAAtB,CACD,CACD;AACD,CAjEH","sourcesContent":["//var nodemail = require('nodemailer');\nconst mailgun = require(\"mailgun-js\");\nconst DOMAIN = 'https://new-email-app.herokuapp.com/';\nconst api_key = '6e3b8f6090c00c22a964a71df0571b60-2af183ba-540063c1';\nconst mg = mailgun({apiKey: api_key, domain: DOMAIN}); \n\nmodule.exports= function send_email_db(req){\n    console.log(\"req==\"+ req);\n    //break;\n    var receiver_emails='';\n    var sender_email='';\n    var date = new Date();\n    if(req){        \n          sender_email = req.sender_email;\n        receiver_emails = req.receiver_email.split(',');\n          \n        var email_status   =  req.email_status;\n        var email_subject = req.email_subject;\n        var email_body = req.email_body;\n        console.log(\"convert==\"+receiver_emails.length);        \n    }\n  \n  \n    const email_output = `\n        \n        <h3>Your emails sent ${email_subject}</h3>\n        <ul>\n            <li> Email ${email_body}</li>\n        </ul>\n    `;\n  \n    // let tranport_email = nodemail.createTransport({\n    //   port: 587,\n    //   address: 'smtp.mailgun.org',    \n    //   host: 'https://new-email-app.herokuapp.com/',\n    //     auth: {\n    //         user: 'postmaster@sandbox9ec8e5daaec146fca37a45479baea5f2.mailgun.org' ,\n    //         pass: '98e50b79f92e630a413bc3d8a7716c02-2af183ba-fa201257',\n    //     }\n    // });\n    \n    var email_counter_start =0;\n    var receiver_email_list =0;\n  \n    email_status === \"all\" ? receiver_email_list=[receiver_emails] : receiver_email_list = receiver_emails;\n       \n    while  (email_counter_start < receiver_email_list.length) {\n    \n      console.log(\"email options==\"+receiver_email_list[email_counter_start]);\n        let mailoptions = {\n            from: sender_email, //\"yamin.barakat@gmail.com\",\n            to: receiver_email_list[email_counter_start],\n            subject: email_subject+'  '+date,\n            text: email_body,\n            html: email_output\n        };\n        \n        mg.messages().send(mailoptions, function (error, body) {\n            console.log(body);\n        });\n    \n        // tranport_email.sendMail(mailoptions, (err, info)=>{\n        //     if(err) {\n        //         return console.log(err);\n        //     }\n        //     console.log('email sent %s', info.messageId );\n        // });\n      \n      email_counter_start +=1;\n    }\n    //send_DB(req, res);\n  }\n\n"]},"metadata":{},"sourceType":"module"}